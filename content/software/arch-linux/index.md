---
title: Arch Linux
publishDate: 2024-03-28T16:43:56Z
lastmod: 2026-02-08T13:31:00Z
#categories: [linux]
contributors: [kttrickster]
---

В основе Arch Linux лежит принцип «сделай сам» (Do It Yourself). Если вы
собираетесь установить и пользоваться Arch Linux или его производными,
предполагается следующее:

- Вы готовы к неожиданному поведению после обновлений или изменений
конфигурации;
- У вас имеются резервные копии данных, снимки системы и USB-накопитель с
Live-окружением для восстановления;
- Вы готовы регулярно проводить обслуживание системы;
- Вы готовы самостоятельно находить решения проблем в интернете и изучать
официальные руководства.

Если вышесказанное относится к вам, то у вас должна получиться стабильная
система, которой будет приятно пользоваться.

> **Смотрите также:**
[Часто задаваемые вопросы](https://wiki.archlinux.org/title/Frequently_asked_questions_(Русский))
— ArchWiki

## Производные

> **Смотрите также:**
[Дистрибутивы, основанные на Arch](https://wiki.archlinux.org/title/Arch-based_distributions_(Русский))
— ArchWiki

> [!important]
> Все официальные и большинство сторонних ресурсов про Arch Linux, включая эту
страницу, не предусматривают применение на производных дистрибутивах. Вы **не**
используете Arch Linux, если пользуетесь его производными.

### EndeavourOS

[EndeavourOS](https://endeavouros.com) предоставляет возможность установить Arch
Linux без хлопот. Имеет графический установщик, в котором можно выбрать
устанавливаемое программное обеспечение, а также собственное оформление
внешнего вида. Используются официальные репозитории Arch Linux и собственный
репозиторий с дополнительными программами.

Этот дистрибутив самый простой и наиболее близкий к Arch Linux. Отлично подходит
для первого знакомства с ним.

### Manjaro

[Manjaro](https://manjaro.org) нацелен на простую установку, стабильность и
поддержку. Имеет графический установщик, несколько вариантов оболочек и
предустановленное оформление внешнего вида.

Manjaro использует свои репозитории, в которых обновления откладываются на
несколько недель в целях дополнительного тестирования. Некоторые считают это
бессмысленным, ведь обновления в Arch Linux также тестируются перед выпуском в
стабильную ветку. Это дополнительный период ожидания перед получением новых
функций, исправлений ошибок и патчей безопасности. К тому же это может сломать
некоторые пакеты из пользовательского репозитория (AUR), если они зависят от
более новых версий библиотек.

Также Manjaro [известен проблемами], которые периодически происходили в прошлом.
Не один раз забывали продлевать сертификаты и вызывали DDoS-атаку на AUR.

Несмотря на общую основу, Manjaro очень далёк от Arch Linux.

[известен проблемами]: https://manjarno.pages.dev

## Установка и настройка

Arch Linux традиционно устанавливается вручную. Это на самом деле не так сложно,
как может показаться, и в процессе можно узнать, как устроена работа
Unix-подобных систем и компьютеров в целом.

Тем не менее доступен автоматический установщик Archinstall, который позволяет
легко установить систему аналогично другим.

Руководство по установке и настройке Arch Linux находится на
[отдельной странице](/guides/arch-linux-setup).

## Обслуживание системы

> **Смотрите также:**
[Обслуживание системы](https://wiki.archlinux.org/title/System_maintenance_(Русский))
— ArchWiki

Вы должны регулярно обновлять систему командой `sudo pacman -Syu`. Частичные
обновления могут сломать систему — всегда обновляйте полностью. Перед тем, как
сообщать о проблемах, система должна быть полностью обновлена. Рекомендуется
перезагружать компьютер после обновления, если это были системные компоненты
(из репозитория core).

### Исправление проблем

> **Смотрите также:**
[Устранение неполадок в системе](https://wiki.archlinux.org/title/General_troubleshooting_(Русский))
— ArchWiki

- Смотрите журнал системы:
    - `sudo journalctl -b` — Текущий сеанс.
    - `sudo journalctl -b-1` — Предыдущий сеанс (цифра указывает количество
    сеансов назад).
    - `sudo journalctl -b-1 > logs.txt` — Записать журнал в файл.
- Проверяйте ошибки в службах: `systemctl --failed`.
- Сколько времени заняла загрузка системы:
    - По этапам: `systemd-analyze`.
    - По службам: `systemd-analyze blame`.
- После обновлений системы могут появляться новые конфигурационные файлы:
`find /etc -name *.pac*` (bash/zsh).

### Снимки системы

Настройте автоматическое создание снимков системы для возможности восстановления
в случае неудачных обновлений или изменений конфигурации.

Файловая система Btrfs позволяет создавать снимки раздела моментально с
минимальной затратой места на диске.

#### Timeshift

[Timeshift](https://wiki.archlinux.org/title/Timeshift) — графическая программа
для создания автоматических снимков системы. Поддерживаются режимы Btrfs для
соответствующей файловой системы, и Rsync для других.

```sh
sudo pacman -S timeshift
# Запустите Timeshift и завершите настройку.

# Включите эту службу, иначе периодическое создание снимков не будет работать.
sudo systemctl enable cronie.service
sudo systemctl start cronie.service

# Проверить список снимков для Btrfs
sudo btrfs subvolume list /  # /home
```

## Pacman

### Использование

|Команда|Описание|
|:-----:|--------|
|`sudo pacman -Syu`|Обновить все системные пакеты
|`sudo pacman -Rns`|Удалить пакеты со всеми зависимостями, при возможности очистив данные
|`pacman -Ss`|Поиск пакетов
|`pacman -Qtd`|Список неиспользуемых пакетов
|`pacman -Qm`|Список пакетов не из официальных репозиториев (AUR)
|`pacman -Qi`|Информация о пакетах
|`pacman -Qqe`|Вывести установленные пользователем пакеты

Сохранить список установленных пакетов: `pacman -Qqe > packages-1.txt`.
Сравнить с текущим: `diff packages-old.txt packages-new.txt`.

### Графический интерфейс

Можно обновлять пакеты через [графический интерфейс] (например, `discover` или
`gnome-software`), если установить `packagekit` (и `packagekit-qt6`). Однако это
не рекомендуется, так как могут возникнуть проблемы. Через консольный интерфейс
можно увидеть ошибки и предупреждения, которые можно вовремя исправить.

Графический интерфейс центра приложений лучше подходит для пакетов Flatpak.

[графический интерфейс]: https://wiki.archlinux.org/title/Pacman_(Русский)/Tips_and_tricks_(Русский)#Графические

### Пакеты

Здесь будут перечислены пакеты, которые обычно не устанавливаются по умолчанию,
но их отсутствие приводит к утрате функциональности системы.

#### Компоненты

|Название пакета|Описание|
|:-------------:|--------|
|`ntfs-3g`, `exfat-utils`, `btrfs-progs`|Поддержка файловых систем
|`unrar`|Разархивация RAR
|`cups`|Служба печати [CUPS] (`systemctl enable cups.service && systemctl start cups.service`)
|`power-profiles-daemon`|Профили энергопотребления для ноутбука
|`aspell-en`, `aspell-ru`|Проверка орфографии
|`noto-fonts-emoji`|Эмодзи
|`noto-fonts-cjk`|Китайские, японские и корейские символы
|`tk`|Tkinter для Python
|`base-devel`|Пакеты для сборки программ из исходного кода

[CUPS]: https://wiki.archlinux.org/title/CUPS_(Русский)

#### Инструменты

|Название пакета|Описание|
|:-------------:|--------|
|`tldr` / `tealdeer`|Краткое руководство команд ([tldr pages])
|`fastfetch` / `neofetch`|Информация о системе в терминале
|`btop` / `htop`|Системный монитор в терминале
|`lshw`|Информация об оборудовании
|`flatpak`|Пакетный менеджер [Flatpak] [^1]
|`git`|Система контроля версий для работы с исходным кодом программ
|[Языковые серверы]|Для текстовых редакторов (Kate, Neovim)
|`fwupd`|[Обновление прошивки]

[tldr pages]: https://tldr.sh
[Flatpak]: https://wiki.archlinux.org/title/Flatpak
[Языковые серверы]: https://wiki.archlinux.org/title/Language_Server_Protocol
[Обновление прошивки]: https://wiki.archlinux.org/title/Fwupd

### Конфигурация

Файл конфигурации — `/etc/pacman.conf`.

Уберите `#` перед строками:
- `Color` — Включает цвета
- `ParallelDownloads` — Включает параллельное скачивание, можно указать
количество потоков

Добавьте строку `ILoveCandy`, чтобы изменить стиль полосы прогресса скачивания.

Проверить изменения можно командой `sudo pacman -Syy`.

### Репозитории

Чтобы включить другие репозитории, нужно убрать `#` перед названием репозитория
и 'Include' под ним:

```conf
# /etc/pacman.conf

[multilib]
Include = /etc/pacman.d/mirrorlist
```

`multilib` — репозиторий с 32-битными программами. Включите его, чтобы иметь
возможность установить Steam[^2] и дополнительные пакеты для Wine.

Также есть репозитории *-testing, в которых тестируются новые версии пакетов.
Они сделают систему более нестабильной, но дадут попробовать новейшее
программное обеспечение.

После изменения включённых репозиториев нужно обновить систему.

### Обновление списка зеркал

```sh
sudo pacman -S reflector

# Сделайте резервную копию текущего списка
sudo cp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.bak

sudo reflector --verbose --country 'Germany,Russia,' --latest 20 \
    --protocol https --sort rate --save /etc/pacman.d/mirrorlist
```

Включите службу и таймер для автоматического обновления зеркал. Перед этим
настройте конфигурацию Reflector:

```sh
sudo nano /etc/xdg/reflector/reflector.conf
sudo systemctl enable reflector.service
sudo systemctl enable reflector.timer
sudo systemctl start reflector.timer
```

Если в репозиториях появляется новый пакет, то зеркала могут не успеть его
получить, что приведёт к ошибке 404. Вы можете подождать или сортировать
зеркала по времени последнего обновления: `--age 12` (часов).

### Очистка кэша

> **Основная статья:**
[Pacman — Очистка кэша пакетов](https://wiki.archlinux.org/title/Pacman_(Русский)#Очистка_кэша_пакетов)
— ArchWiki

При обновлении и установке пакетов сохраняются старые версии для возможности
[быстрого отката]. Настройте автоматическое удаление старых архивов каждую
неделю:

```sh
sudo pacman -S pacman-contrib
sudo systemctl enable paccache.timer
sudo systemctl start paccache.timer
```

Также можно очищать кэш вручную. `sudo pacman -Sc` удалит кэш неустановленных
пакетов, а `sudo pacman -Scc` удалит весь кэш. Последнюю команду не
рекомендуется выполнять, если нет крайней необходимости освободить место на
диске.

[быстрого отката]: #понижение-версии-пакетов

### Arch User Repository (AUR)

> **Основная статья:**
[Arch User Repository](https://wiki.archlinux.org/title/Arch_User_Repository_(Русский))
— ArchWiki

В [пользовательском репозитории](https://aur.archlinux.org) можно найти
практически любую программу. Это хоть и удобно, но добавляет риски безопасности
и поломки системы, поскольку эти пакеты официально не поддерживаются.
Большинство пакетов из AUR компилируются (если не оканчиваются на -bin). Также
можно найти программы последней нестабильной версии (оканчиваются на -git).

Вы можете использовать AUR для лёгкой и быстрой установки любой программы, но
увлекаться им не стоит. Большинство нужных программ есть во
[Flathub](https://flathub.org)

Чтобы легко устанавливать и обновлять пакеты из AUR, установите помощник,
например, `yay` или `paru`:

```sh
sudo pacman -S --needed git base-devel
git clone https://aur.archlinux.org/yay
cd yay
makepkg -sric

yay librewolf  # Поиск пакетов
yay -S librewolf-bin  # Установка из AUR
```

> [!important]
> Перед установкой пакета из AUR следует проверять содержимое файла `PKGBUILD` и
его изменения при обновлении (`git diff master` / нажать `A`, когда yay
попросит показать изменения). Этот файл является "рецептом" сборки пакета, и
может содержать [вредоносный код](https://opennet.ru/63604).

`yay` также можно использовать в качестве обёртки для `pacman`:

```sh
yay firefox  # Поиск пакетов
yay -S firefox  # Установка пакетов из официальных репозиториев
yay  # Обновление системы (sudo pacman -Syu)
```

AUR-помощники `yay` и `paru` создают собственную директорию кэша. Очищайте его
[аналогично pacman](#очистка-кэша) параметрами `-Sc` и `-Scc`.

Репозиторий AUR размещён на единственном домене `aur.archlinux.org`, а файлы
сборки могут быть расположены на различных серверах. Если вам нужен прокси для
доступа к серверам, задайте его с помощью переменной среды `https_proxy`:

```sh
https_proxy="127.0.0.1:2080" yay [...]
```

То же самое можно сделать и с другими программами, например, `git` или `flatpak`.

Зеркало `aur.archlinux.org` размещено на GitHub:

```sh
git clone --branch <имя_пакета> --single-branch https://github.com/archlinux/aur.git <имя_пакета>
```

### Новости

[На официальном сайте](https://archlinux.org/news) иногда появляются новости,
которые всегда требуют внимания. Это могут быть изменения в пакетах. Чтобы не
сломать систему, нужно получать новости перед выполнением обновлений. Эту задачу
решает Informant (AUR).

```sh
yay -S informant
yay
sudo informant read
```

> [!important]
> После крупных обновлений Python, Informant понадобится переустановить:
`yay -S informant`.
[Подробнее](https://aur.archlinux.org/packages/informant#comment-970197)

### Понижение версии пакетов

> **Основная статья:**
[Downgrading packages](https://wiki.archlinux.org/title/Downgrading_packages)
— Arch Wiki

В случае неудачного обновления в системе может что-то сломаться, и вам
потребуется понизить версию одного или нескольких пакетов.

Сначала определите, что могло вызвать проблему. Для этого смотрите журнал
пакетного менеджера:

```sh
less /var/log/pacman.log
```

Попытайтесь найти отчёты о проблеме в интернете. Возможно, кто-то испытывает
ту же самую проблему.

Найдите пакет в [репозитории](https://archlinux.org/packages). Посмотрите
изменения (View changes). Может, вышла новая версия, которая исправила проблему?

Попробуйте восстановить старую версию пакета из кэша:

```sh
sudo pacman -U file:///var/cache/pacman/pkg/пакет-старая_версия.pkg.tar.тип
```

Если вы откатываете много пакетов, то, возможно, лучше будет восстановить
[снимок системы](#снимки-системы).

## ArchWiki

[ArchWiki](https://wiki.archlinux.org/title/ArchWiki:About_(Русский)) — главный
ресурс для получения информации про Arch Linux, но он также может быть полезен
и для других дистрибутивов. В случае возникновения каких-либо проблем или
необходимости получения справки, стоит проверять ArchWiki. Это самый богатый
ресурс, который создаётся сообществом.

Список интересных страниц для ознакомления:

- [Основные рекомендации](https://wiki.archlinux.org/title/General_recommendations_(Русский))
- [Обслуживание системы](https://wiki.archlinux.org/title/System_maintenance_(Русский))
- [Устранение неполадок в системе](https://wiki.archlinux.org/title/General_troubleshooting_(Русский))
- [Улучшение производительности](https://wiki.archlinux.org/title/Improving_performance_(Русский))
- [Безопасность](https://wiki.archlinux.org/title/Security_(Русский))
- [Расширения для браузеров](https://wiki.archlinux.org/title/Browser_extensions_(Русский))
- [Ноутбук](https://wiki.archlinux.org/title/Laptop) (англ.)
- [Игры](https://wiki.archlinux.org/title/Gaming) (англ.)
- [Исправление проблем в определённых играх](https://wiki.archlinux.org/title/Steam/Game-specific_troubleshooting) (англ.)
- [Dotfiles](https://wiki.archlinux.org/title/Dotfiles) (англ.)
- [ASCII-арт](https://wiki.archlinux.org/title/ASCII_art) (англ.)


[^1]: Вы можете использовать Flatpak для установки графических программ:
браузер, офис, утилиты, мессенджеры — все они доступны во
[Flathub](https://flathub.org). Пакеты Flatpak находятся в песочнице и не
устанавливаются как системные компоненты, что может повысить стабильность
системы, особенно если заменить ими пакеты из AUR. Некоторые разработчики
официально распространяют свои программы во Flathub, и они доступны во всех
дистрибутивах. Иногда можно столкнуться с проблемами: некорректная тема или
отсутствие разрешений. Для управления разрешениями можно использовать
[Flatseal](https://flathub.org/apps/com.github.tchx84.Flatseal) или меню
параметров системы `flatpak-kcm` в KDE Plasma. Существуют удобные графические
интерфейсы для Flatpak: `discover`, `gnome-software`,
[Bazaar](https://flathub.org/apps/io.github.kolunmi.Bazaar).

[^2]: Steam можно установить через Flatpak, в таком случае вам не потребуется
включать репозиторий multilib. Так как Steam и все запускаемые через него игры
будут находиться в песочнице, это может вызвать некоторые проблемы.
